// Render filters
$('.filter-topdomain .content').html("<%= escape_javascript (render partial: 'extensions') %>");

$('.product').remove();
$('.wrap').remove();
// Render results
$('.content-wrapper').append("<%= escape_javascript (render partial: 'result', collection: @suggested, as: :result) %>");
$('.content-wrapper').append("<%= escape_javascript (render partial: 'result', collection: @results, as: :result) %>");

// Check all checkboxes
$('.filter-topdomain input:checkbox').prop('checked', true);

//On new domain search
$('body .domain-search').submit(function(event){
  $('.product').fadeOut(200);
  $('.cd-main-content .content-wrapper').append("<div class='wrap'><div class='loading'><div class='bounceball'></div><div class='text'>Searching. Please wait...</div></div></div>");
});

// filter products on checkbox change
$('.filter-topdomain input').on("click tap", function(){
	$('.product').removeClass('faded').removeClass('active');
	$('.product .footer').hide();

	if($(this).hasClass('all')){
		if($(this).is(':checked')){
			$('.filter-topdomain input:checkbox').prop('checked', this.checked);
		} else{
			$('.filter-topdomain input:checkbox').prop('checked', false);
		}
	} else{
		if(!$(this).is(':checked')){
			$('.filter-topdomain input.all:checkbox').prop('checked', false);
		}
	}
	filter();
	updateCount();
});

function filter(){
	var extension;
	var inputs = $('.filter-topdomain input:checked');

	$('.product').hide();
	inputs.each(function(){
		extension = $(this).attr("data-topdomain");
		$('.product').each(function(){
			if($(this).attr("data-topdomain") == extension){
				$(this).show();
			}
		});
	})
}	

function updateCount(){
  $('.info-search b').text($('.content-wrapper .product:visible').length);
}

updateCount();

$('.add-to-cart').on('click tap', function(){
  $(this).prop('disabled', true);
  $(this).html("Added");
});